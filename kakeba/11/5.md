默认的内存分配器 jemalloc  
其他的 libc 、 tcmalloc 性能差一些  

jemalloc 先会申请一块较大的空间。redis 中发起内存申请时，在这块空间中进行分配  

内存分配规则  

| Category | Spacing | Size |
| :- | :- | :- |
| Small | 8 | \[8\] |
| | 16 | \[16,32,46,...,128\] |
| | 32 | \[160,192,224,256\] |
| | 64 | \[320,384,448,512\] |
| | 128 | \[640,768,896,1024\] |
| | 256 | \[1280,1536,1792,2048\] |
| | 512 | \[2560,3072,3584\] |
| Large | 4KiB | \[4KiB,8KiB,12KiB,...,4072KiB\] |
| Huge | 4MiB | \[4MiB，8MiB,12MiB,...,4072MiB\] |

例 需要 130 Byte 时会申请到 160 Byte 的内存单元  

注：KiB 和 KB 的区别： 1 MB = 1000 KB，1 MiB = 1024 KiB, 1 KiB = 1.024 KB  

[back](../11.md)  