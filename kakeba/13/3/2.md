获取偏向锁的过程  

检查 Mark Word 中**是否偏向锁**和**锁标志位**  

可偏向状态  
- 锁标志位为 01  
- 是否偏向锁为 1   
检查 Mark Word 中的线程ID是否和当前线程相同，相同表示已经获得了锁  
如不相同，则检查 Mark Word 的偏向锁标识是否为 1  
    - 没有设置，使用 CAS 操作竞争锁  
    - 设置为 1，尝试使用 CAS 将 Mark Word 中线程 ID 设置为当前线程  
    如果尝试失败，说明有竞争。到达全局安全点之前获得偏向锁的线程被挂起，偏向锁升级为轻量级锁，然后被阻塞在安全点的线程继续往下执行同步代码  


[back](../3.md)  