Sleuth 对分布式服务调用生成跟踪日志，兼容了 Zipkin，HTrace  

- Trace：跟踪单元从客户端发起的请求抵达跟踪系统边界开始，到被跟踪系统向客户返回响应为止的过程   
- Span：每个 trace 中会调用若干个服务，为了记录调用了哪些服务，以及每次调用消耗的时间等信息，在每次调用服务时埋入一个调用记录  
这样两个调用记录之间的区域称为一个 Span  
- annotation: 用于即使记录事件的实体，表示一个事件发生的时间点  
    - cs 发送请求的时间点 Client Send  
    - sr 收到请求的时间点
    - cr 发送响应的时间点
    - ss 收到响应的时间点

Sleuth 生成日志，然后交给 ZipKin   
在工程中添加了 Sleuth 依赖后，工程的运行过程中就会自动生成很多的日志  

Sleuth 支持对日志采样收集，并不是所有日志都上传到日志收集服务器  
默认的采样比例为 0.1 即 10%  
被采样的日志信息会打上收集标记，在 console 里可以看到需要收集的为 true，不需要的为 false  

日志结构大概是  
`... INFO [微服务名称, Trace ID, Span ID, true|false ] ...

水塘抽样算法  

[back](../7.md)  